<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Squallord's Blog</title>
		<link rel="stylesheet" type="text/css" href="/css/main.css">
		<link href="https://fonts.googleapis.com/css?family=Open+Sans|Ubuntu|Droid" rel="stylesheet">
		<link href="/css/syntax.css" rel="stylesheet">
	</head>
	
	<body>
		<header class="top-container">
		<div class="top-left">
			<h1><a href="/index.html">Squallord's Blog</a></h1>
		</div>
		<div class="top-right">
			<nav>
	<ul class="nav nav-top">
		<li><a href="/" class="">Home</a></li>
		<li><a href="/news" class="current">News</a></li>
		<li><a href="/portfolio" class="">Portfolio</a></li>
		<li><a href="/about" class="">About</a></li>
	</ul>
</nav>
		</div>
		</header>

		<div class="container">
			<div class="sidebar">
				<p>Topics:</p>
<ul>

	<li><a href="/news/Programming.html">Programming</a></li>

	<li><a href="/news/2D Art.html">2D Art</a></li>

	<li><a href="/news/3D Art.html">3D Art</a></li>

</ul>
<hr>
<div class="portrait-anim"></div>
<p>About me:</p>
<p>Computer Engineer and Programmer. I love to mess with fun stuff. Nice to meet you! I hope you enjoy my blog and find something useful.</p>
<hr>
<p>E-mail me at:</p>
<p>squallordis@gmail.com</p>
			</div>

			<div class="content">
				<h2 id="how-to-use-my-mosaic-photo-gallery-algorithm">How to use my mosaic photo gallery algorithm</h2>

<p>Firstly, let’s begin with the actual results. The code can be cloned (or downloaded) <a href="https://github.com/squallord/mgallery" style="text-decoration: none; color: darkblue">here</a>. Feel free to use as you wish.</p>

<p>Inside mgallery folder there’s this main python file called <strong>mgallery.py</strong> and a folder called <strong>img_folder</strong>. Inside <strong>img_folder</strong> you should put the images. From about 25 to 30 pics should do it. If you don’t use enough pictures, then the program will end with an error message.</p>

<p>The main function which you should use to get the job done is <strong>mosaic</strong>. Before calling the main function, you need to call the python interpreter. Just follow the instructions bellow:</p>

<ul>
  <li>Open the bash (ctrl + alt + t in most linux distros);</li>
  <li>Navigate to mgallery folder in your system;</li>
  <li>type in python;</li>
</ul>

<p>Then something like this will show up:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>python
Python 2.7.9 <span class="o">(</span>default, Jun 29 2016, 13:08:31<span class="o">)</span> 
<span class="o">[</span>GCC 4.9.2] on linux2
Type <span class="s2">"help"</span>, <span class="s2">"copyright"</span>, <span class="s2">"credits"</span> or <span class="s2">"license"</span> <span class="k">for </span>more information.
<span class="gp">&gt;&gt;&gt; </span></code></pre></figure>

<p>Before we go on I’d like to emphasize that this code is supposed to work just in linux and uses Python 2.7.x (newer versions problaby and/or other systems won’t run it). Here’s how you can make the function call:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mgallery</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mgallery</span><span class="o">.</span><span class="n">mosaic</span><span class="p">()</span></code></pre></figure>

<p>The mosaic function has some default parameters that will be discussed further. After typing the “<em>enter</em>” key, you should get something like the following output:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">pixel chunks: <span class="o">[(</span>1240, 1756<span class="o">)</span>, <span class="o">(</span>1240, 878<span class="o">)</span>, <span class="o">(</span>620, 878<span class="o">)</span>, <span class="o">(</span>620, 439<span class="o">)]</span>
29 pictures to form a mosaic gallery
ID: 19 with name download.jpg could not be resized
program at <span class="c">#1 attempt ...</span>
<span class="gp">&gt; </span>this canvas is completed! final attempt: 2 &lt;
rate of images used: 82.14%
program at <span class="c">#2 attempt ...</span>
<span class="gp">&gt; </span>this canvas is completed! final attempt: 2 &lt;
rate of images used: 92.86%
program at <span class="c">#3 attempt ...</span>
<span class="gp">&gt; </span>this canvas is completed! final attempt: 1 &lt;
rate of images used: 82.14%
program at <span class="c">#4 attempt ...</span>
<span class="gp">&gt; </span>this canvas is completed! final attempt: 1 &lt;
rate of images used: 71.43%
program at <span class="c">#5 attempt ...</span>
<span class="gp">&gt; </span>this canvas is NOT completed! &lt;
rate of images used: 85.71%
program at <span class="c">#6 attempt ...</span>
<span class="gp">&gt; </span>this canvas is completed! final attempt: 2 &lt;
rate of images used: 89.29%
program at <span class="c">#7 attempt ...</span>
<span class="gp">&gt; </span>this canvas is completed! final attempt: 2 &lt;
rate of images used: 92.86%
program at <span class="c">#8 attempt ...</span>
<span class="gp">&gt; </span>this canvas is completed! final attempt: 2 &lt;
rate of images used: 89.29%
program at <span class="c">#9 attempt ...</span>
<span class="gp">&gt; </span>this canvas is completed! final attempt: 2 &lt;
rate of images used: 85.71%
program at <span class="c">#10 attempt ...</span>
<span class="gp">&gt; </span>this canvas is completed! final attempt: 1 &lt;
rate of images used: 75.0%
... 9 completed image canvas
92.86 is the highest rating of this simulation</code></pre></figure>

<p>Then, you can navigate to your mgallery folder and find an image called <strong>mosaic_gallery.jpg</strong>. Jus open it an see the result. Pretty cool, right?</p>

<p><img src="/assets/mgallery/mosaic_gallery_A3_4px_white.jpg" alt="mosaic photo gallery example" class="center-image drop-shadow-image" /></p>

<p>Next step is knowing how to customize this mosaic just a little. The funciton has six parameters. As there’s some complexity involved in most of them, we’ll see just two of them (padding and color) for now. The rest we’ll leave untouched because it requires further knowledge of how the program works. Here is how the function was defined in terms of parameters:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">mosaic</span><span class="p">(</span><span class="n">folderName</span> <span class="o">=</span> <span class="s">"img_folder"</span><span class="p">,</span> \
	   <span class="n">maxAttempts</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">MAX_ATTEMPTS</span><span class="p">,</span> \
	   <span class="n">paperSize</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">SZ_A3</span><span class="p">,</span> \
	   <span class="n">clusterPow</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">SZ_CLSTR</span><span class="p">,</span> \
	   <span class="n">padding</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">DEF_PADDING</span><span class="p">,</span> \
	   <span class="n">color</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">BCKGRND_CLR</span><span class="p">):</span></code></pre></figure>

<p>Where:</p>

<ul>
  <li>folderName [string]: relative path to the folder that contains the images. Default value is “img_folder”;</li>
  <li>maxAttempts [integer]: maximum number of times the algorithm tries to find a solution for the problem. Default value is 10;</li>
  <li>paperSize [tuple]: size of the paper in pixels. Default value is (3512, 4960);</li>
  <li>clusterPow [integer]: 2^clusterPow will define a 2^clusterPow x 2^clusterPow canvas to fit the pictures (this will be explained later on). Default value is 3;</li>
  <li>padding [integer]: padding in pixels to be added to each image. Default value is 2px;</li>
  <li>color [tuple]: the background color. Default value is (255, 255, 255).</li>
</ul>

<p>Let’s try to mess with that around a bit. Let’s call the function with these parameters:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">&gt;&gt;&gt; </span>mgallery.mosaic<span class="o">(</span>padding <span class="o">=</span> 10, color <span class="o">=</span> <span class="o">(</span>0, 0, 200<span class="o">))</span></code></pre></figure>

<p>And that will give us this picture:</p>

<p><img src="/assets/mgallery/mosaic_gallery_A3_10px_blue.jpg" alt="mosaic photo gallery example" class="center-image drop-shadow-image" /></p>

<p>Notice that the borders of each picture are wider and have the blue <strong>rgb</strong>(0, 0, 200) tone to them. These are two of the most important parameters in this function. You can also change the paperSize to a smaller or higher value. But, you should keep the <strong>aspect ratio</strong> (width/height) at <strong>1/1.42</strong> (aproximately one over the square root of two). Other values can result in uneven scaling in some images (this might be improved later). You might as well change the the <em>maxAttempts</em> value, but I do not recommend to do so. In its current state, the program used about <strong>700 MB</strong> of <strong>RAM</strong> and this number will change accordingly to the <strong>number</strong> of pictures and the <strong>size</strong> of each of them, for example. If you have tons of RAM to spare, changing from <strong>10 attempts</strong> (the default) to <strong>1000</strong> should not be a problem. But, in my experience 10 attempts is a good number if you have a good mix of portrait and landscape pictures (in this example I used 12 portrait and 18 landsape pictures).</p>

<p>That’s about all you need to know to get things working! Hope you enjoyed this article! If you find anything that needs to be improved or have any suggestions, please feel free to leave a comment bellow or e-mail me at <a href="mailto:squallordis@gmail.com" style="color: blue; text-decoration: none;">squallordis@gmail.com</a>.</p>

<h4 style="text-align: right; font-weight: normal; margin: 0; padding: 0" id="published-at-march-22-2017">Published at March 22, 2017.</h4>

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function(){ // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://squallordblog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
			</div>
		</div>
		<footer>
			<!--<nav>
	<ul class="nav nav-bottom">
		<li><a href="/" class="">Home</a></li>
		<li><a href="/news" class="current">News</a></li>
		<li><a href="/portfolio" class="">Portfolio</a></li>
		<li><a href="/about" class="">About</a></li>
	</ul>
</nav>-->
			<!--<hr>-->
			<p>2017 Squallord's Blog powered by Jekyll.</p>
		</footer>
	</body>
</html>